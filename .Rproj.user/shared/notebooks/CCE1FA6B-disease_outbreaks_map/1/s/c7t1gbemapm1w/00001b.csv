"0",""
"0","Sys.setenv(LANG = ""en"")"
"0","library(jsonlite)"
"0","library(tidyverse)"
"0","library(leaflet)"
"0","library(httr)"
"0","library(jsonlite)"
"0","library(RColorBrewer)"
"0","library(htmlwidgets)"
"0","library(htmltools)"
"0","library(sf)"
"0","library(bslib)"
"0",""
"0","# Unique DONs"
"0","# Define the GitHub raw content URL"
"0","url_api <- ""https://api.github.com/repos/jatorresmunguia/disease_outbreak_news/contents/Last%20update"""
"0","last_file <- fromJSON(content(GET(url_api), as = ""text""))$name[grepl(fromJSON(content(GET(url_api), as = ""text""))$name, pattern = paste0(""^outbreaks""))]"
"0",""
"0","rdata_file <- last_file[grepl("".csv$"", last_file)]"
"0","file_name <- basename(rdata_file)"
"0","date_string <- sub("".*_(\\d{2})(\\d{2})(\\d{4}).*"", ""\\1-\\2-\\3"", file_name)"
"0","date_obj <- dmy(date_string)"
"0",""
"0","formatted_date <- format(date_obj, ""%d/%m/%Y"")  "
"0","formatted_month <- format(date_obj, ""%B %d, %Y"")     "
"0",""
"0","outbreaks <- read.csv(paste0(""https://raw.githubusercontent.com/jatorresmunguia/disease_outbreak_news/refs/heads/main/Last%20update"", ""/"", rdata_file),"
"0","                         row.names = 1, header = TRUE)"
"0",""
"0","num_countries <- nlevels(factor(outbreaks$Country))"
"0","num_diseases <- nlevels(factor(outbreaks$icd104n))"
"0",""
"0","outbreaks <- outbreaks |>"
"0","  mutate(across(c(icd104n, iso3, Country), "
"0","                ~ factor(str_squish(as.character(.)))))"
"0",""
"0","# geographic data all countries"
"0","# Load the shapefile into R"
"0","url_shp <- ""/vsicurl/https://github.com/jatorresmunguia/outbreaks_dashboard/raw/main/Data/shp_outbreaks.shp"""
"0","shpsf <- st_read(url_shp, quiet = TRUE)"
"0",""
"0","shpsf_unique <- shpsf |> "
"0","  st_drop_geometry() |>"
"0","  distinct(iso3, .keep_all = TRUE)"
"0",""
"0","outbreaks <- shpsf_unique |>"
"0","  select(iso3, continent) |>"
"0","  right_join(outbreaks, by = ""iso3"") "
"0",""
"0","rm(url_shp, shpsf_unique, date_obj, date_string, file_name, last_file, rdata_file, url_api)"
"0",""
"0","# For input Year"
"0","min_Year <- min(outbreaks$Year)"
"0","max_Year <- max(outbreaks$Year)"
"0",""
